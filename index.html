<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CRYPTO WITCH | Cybernetic Memecoin Sorcery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Oxanium:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* [Keep all your existing CSS exactly the same] */
    :root {
      --neon-purple: #bc13fe;
      --neon-teal: #0ff0fc;
      --neon-pink: #ff2ced;
      --matrix-green: #00ff41;
      --cyber-yellow: #f5d90a;
    }
    
    body {
      font-family: 'Oxanium', sans-serif;
      background-color: #0a0a0a;
      color: white;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(188, 19, 254, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(15, 240, 252, 0.1) 0%, transparent 20%),
        linear-gradient(to bottom, rgba(10, 10, 10, 1), rgba(5, 5, 15, 1));
    }

    /* [Rest of your CSS remains unchanged] */
    
  </style>
</head>
<body>
  <!-- [Keep all your existing HTML exactly the same until the script] -->
  
  <script>
    // ===================== AUDIO SYSTEM =====================
    const bgMusic = new Audio('witches-cauldron-153084.mp3');
    bgMusic.loop = true;
    bgMusic.volume = 0.3;

    // Spell system with preloaded sounds
    const spellBook = [
      {
        name: "Potion of Pump",
        effect: "Increases token value by 13.37%",
        color: "#ff2ced",
        sound: "https://assets.mixkit.co/sfx/preview/mixkit-magical-fairy-spell-869.mp3"
      },
      {
        name: "Hex of HODL",
        effect: "Locks weak hands into diamond status",
        color: "#0ff0fc",
        sound: "https://assets.mixkit.co/sfx/preview/mixkit-magic-spell-875.mp3"
      },
      {
        name: "Moonbeam Charm",
        effect: "Accelerates chart trajectory",
        color: "#f5d90a",
        sound: "https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"
      },
      {
        name: "FUD Repellent",
        effect: "Dispels negative energy",
        color: "#00ff41",
        sound: "https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"
      }
    ];

    // Preload all spell sounds
    const spellSounds = {};
    spellBook.forEach(spell => {
      spellSounds[spell.name] = new Audio(spell.sound);
      spellSounds[spell.name].volume = 0.7;
    });

    // Click sound
    const clickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3');
    clickSound.volume = 0.5;

    // ===================== CORE FUNCTIONALITY =====================
    let musicPlaying = false;
    let audioEnabled = false;

    function enableAudio() {
      if (audioEnabled) return;
      audioEnabled = true;
      
      // iOS workaround - play silent audio first
      const silentAudio = new Audio();
      silentAudio.src = 'data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ...';
      silentAudio.play().then(() => {
        silentAudio.remove();
        
        // Now enable main audio
        bgMusic.play().then(() => {
          musicPlaying = true;
          document.getElementById('musicIcon').style.fill = '#000';
          document.getElementById('audioWarning').style.display = 'none';
        }).catch(showAudioError);
      }).catch(showAudioError);
    }

    function showAudioError() {
      console.log("Audio blocked");
      document.getElementById('musicIcon').style.fill = 'var(--neon-pink)';
      document.getElementById('audioWarning').style.display = 'block';
    }

    // ===================== EVENT HANDLERS =====================
    // Enable audio on first interaction
    ['click', 'touchstart', 'keydown'].forEach(event => {
      document.addEventListener(event, enableAudio, { once: true });
    });

    // Music toggle
    document.getElementById('musicToggle').addEventListener('click', (e) => {
      e.stopPropagation();
      
      // Play click sound if possible
      clickSound.play().catch(e => console.log("Click sound blocked"));
      
      if (musicPlaying) {
        bgMusic.pause();
        document.getElementById('musicIcon').style.fill = 'var(--neon-teal)';
      } else {
        bgMusic.play()
          .then(() => {
            document.getElementById('musicIcon').style.fill = '#000';
            document.getElementById('audioWarning').style.display = 'none';
          })
          .catch(showAudioError);
      }
      musicPlaying = !musicPlaying;
    });

    // ===================== SPELL SYSTEM =====================
    function castSpell() {
      if (!audioEnabled) {
        enableAudio();
        setTimeout(castSpell, 100); // Retry after enabling audio
        return;
      }

      const spell = spellBook[Math.floor(Math.random() * spellBook.length)];
      
      try {
        // Play spell sound
        spellSounds[spell.name].currentTime = 0;
        spellSounds[spell.name].play().catch(e => console.log("Spell sound blocked:", e));
      } catch (e) {
        console.error("Sound error:", e);
      }

      // Update modal
      const modal = document.getElementById('spellModal');
      modal.querySelector('h2').textContent = `${spell.name.toUpperCase()} CAST!`;
      
      const spellList = modal.querySelector('.spell-list');
      spellList.innerHTML = `
        <div class="spell-item" style="color:${spell.color}">
          <strong>${spell.name}:</strong> ${spell.effect}
        </div>
        <div class="mt-4 text-sm" style="color:${spell.color}">
          Spell intensity: ${Math.floor(Math.random() * 100)}%
        </div>
      `;
      
      // Visual effects
      const animation = document.getElementById('spellAnimation');
      animation.style.display = 'block';
      
      for (let i = 0; i < 75; i++) {
        setTimeout(() => {
          createParticle(
            Math.random() * window.innerWidth,
            Math.random() * window.innerHeight,
            spell.color
          );
        }, i * 15);
      }
      
      setTimeout(() => {
        animation.style.display = 'none';
        modal.style.display = 'block';
      }, 1200);
    }

    function createParticle(x, y, color) {
      const particle = document.createElement('div');
      particle.className = 'spell-particle';
      particle.style.backgroundColor = color;
      particle.style.boxShadow = `0 0 10px ${color}`;
      
      const size = Math.random() * 12 + 3;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      particle.style.left = `${x}px`;
      particle.style.top = `${y}px`;
      
      particle.animate([
        { transform: 'translate(0, 0) scale(1)', opacity: 1 },
        { 
          transform: `translate(${Math.random() * 300 - 150}px, ${Math.random() * 300 - 150}px) scale(0)`,
          opacity: 0
        }
      ], {
        duration: Math.random() * 1500 + 500,
        easing: 'cubic-bezier(0,0.2,0.8,1)'
      }).onfinish = () => particle.remove();
      
      document.getElementById('spellAnimation').appendChild(particle);
    }

    function closeSpellModal() {
      document.getElementById('spellModal').style.display = 'none';
    }

    // ===================== INITIALIZATION =====================
    // Glitch effects
    setInterval(() => {
      const elements = document.querySelectorAll('.glitch, .terminal, .cyber-button');
      const randomElement = elements[Math.floor(Math.random() * elements.length)];
      randomElement.classList.add('glitch-active');
      setTimeout(() => {
        randomElement.classList.remove('glitch-active');
      }, 300);
    }, 5000);

    // Initial audio warning
    setTimeout(() => {
      if (!musicPlaying) {
        document.getElementById('audioWarning').style.display = 'block';
      }
    }, 3000);
  </script>
</body>
</html>
